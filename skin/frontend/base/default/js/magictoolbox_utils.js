function magicToolboxPrepareOptions(){var o;if("undefined"!=typeof optionsPrice.productId)o=optionsPrice.productId;else{var e=document.getElementsByName("product");o=e.length?e[0].value:magicToolboxProductId}var t=document.getElementById("MagicToolboxSelectors"+o);t&&(magicToolboxLinks=t.getElementsByTagName("a"));for(var i in optionLabels){var n=document.getElementsByName("options["+i+"]");if(n)for(var a=0,l=n.length;l>a;a++){var c="radio"==n[a].type?"click":"change";$mjs(n[a])[magicAddEvent](c,function(o){var e=o.target||o.srcElement,t=e.name.replace("options[","").replace("]","");magicToolboxOnChangeOption(e,optionTitles[t])})}}if("undefined"!=typeof spConfig&&"undefined"!=typeof spConfig.config.attributes)for(var r in spConfig.config.attributes){optionLabels[r]={},optionProductIDs[r]={},optionTitles[r]=spConfig.config.attributes[r].label.toLowerCase();for(var i in spConfig.config.attributes[r].options){var s=spConfig.config.attributes[r].options[i];if("object"==typeof s){optionLabels[r][s.id]=s.label.replace(/(^\s+)|(\s+$)/g,"").toLowerCase(),optionProductIDs[r][s.id]={};for(var a=0,g=s.products.length;g>a;a++)optionProductIDs[r][s.id][a]=s.products[a]}}var d=document.getElementById("attribute"+r);d&&$mjs(d)[magicAddEvent]("change",function(o){var e=o.target||o.srcElement,t=e.id.replace("attribute","");magicToolboxOnChangeOptionConfigurable(e,optionTitles[t])})}if(document.getElementById("magic360Container"))for(var u=0,m=magicToolboxLinks.length;m>u;u++)$mjs(magicToolboxLinks[u])[magicAddEvent](magicToolboxSwitchMetod,function(e){var t=e.target||e.srcElement;"img"==t.tagName.toLowerCase()&&(t=t.parentNode);var i="none"!=document.getElementById("magic360Container").style.display,n=t.className.match(new RegExp("(?:\\s|^)magic360selector(?:\\s|$)"));if(n&&!i)document.getElementById("mainImageContainer").style.display="none",document.getElementById("magic360Container").style.display="block";else if(i&&(!n||1==magicToolboxLinks.length||magicToolboxLinks[0].className.match(new RegExp("(?:\\s|^)magic360selector(?:\\s|$)"))&&magicToolboxLinks[1].className.match(/(?:\s|^)hidden\-selector(?:\s|$)/)))if(document.getElementById("magic360Container").style.display="none",document.getElementById("mainImageContainer").style.display="block","magicmagnify"==magicToolboxTool){if(!n){MagicMagnify.stop();var a=document.getElementById("MagicMagnifyImage"+o);a.href=t.href,a.firstChild.src=t.rev,MagicMagnify.start()}}else if("magicmagnifyplus"==magicToolboxTool&&!n){MagicMagnifyPlus.stop();var a=document.getElementById("MagicMagnifyPlusImage"+o);a.href=t.href,a.firstChild.src=t.rev,MagicMagnifyPlus.start()}return!1})}function magicToolboxClickElement(o,e,t){var i;return document.createEvent?(i=document.createEvent(e),i.initEvent(t,!0,!0),o.dispatchEvent(i)):(i=document.createEventObject(),i.eventType=e,o.fireEvent("on"+t,i)),i}function magicToolboxOnChangeOption(o,e){if(!allowMagicToolboxChange)return void(allowMagicToolboxChange=!0);if(magicToolboxInArray(e,magicToolboxOptionTitles)){var t="";if("radio"==o.type&&o.checked)t=o.name.replace("options[","").replace("]","");else{if("select-one"!=o.type)return;t=o.id.replace("select_","").replace("attribute","")}if(""==o.value||"undefined"==typeof optionLabels[t][o.value])return;for(var i=optionLabels[t][o.value],n=0,a=magicToolboxLinks.length;a>n;n++)if(magicToolboxLinks[n].firstChild.getAttribute("alt").replace(/(^\s+)|(\s+$)/g,"").toLowerCase()==i){allowMagicToolboxChange=!1,magicToolboxClickElement(magicToolboxLinks[n],"MouseEvents",magicToolboxSwitchMetod);break}}}function magicToolboxOnChangeSelector(o){if(!allowMagicToolboxChange)return void(allowMagicToolboxChange=!0);var e=o.firstChild.getAttribute("alt").replace(/(^\s+)|(\s+$)/g,"").toLowerCase();for(var t in optionLabels)for(var i in optionLabels[t])if(optionLabels[t][i]==e&&magicToolboxInArray(optionTitles[t],magicToolboxOptionTitles))for(var n=["options["+t+"]","super_attribute["+t+"]"],a=0,l=n.length;l>a;a++)for(var c=document.getElementsByName(n[a]),r=0,s=c.length;s>r;r++)if("radio"==c[r].type){if(c[r].value==i)return void setTimeout(function(o){return function(){for(var e=document.getElementsByName(o.name),t=0,i=e.length;i>t;t++)e[t].checked=!1;o.checked=!0,allowMagicToolboxChange=!1,magicToolboxClickElement(o,"Event","click")}}(c[r]),magicToolboxMouseoverDelay)}else{if("select-one"!=c[r].type)break;if(c[r].options&&!c[r].disabled)for(var g=0,d=c[r].options.length;d>g;g++)if(c[r].options[g].value==i)return void setTimeout(function(o,e){return function(){o.value=e,o.selectedIndex=g,allowMagicToolboxChange=!1,magicToolboxClickElement(o,"Event","change")}}(c[r],c[r].options[g].value),magicToolboxMouseoverDelay)}}function magicToolboxOnChangeSelectorConfigurable(o){if(!allowMagicToolboxChange)return void(allowMagicToolboxChange=!0);if("undefined"!=typeof useAssociatedProductImages){var e=o.getAttribute("data-id"),t=magicToolboxFindOptions(e);"undefined"!=typeof spConfig&&"undefined"!=typeof spConfig.settings&&setTimeout(function(o){return function(){magicToolboxChangeOptions(0,o)}}(t),magicToolboxMouseoverDelay)}}function magicToolboxFindOptions(o){var e={};for(var t in optionProductIDs)for(var i in optionProductIDs[t])for(var n in optionProductIDs[t][i])o==optionProductIDs[t][i][n]&&(e[t]=i);return e}function magicToolboxChangeOptions(o,e){var t=spConfig.settings[o],i=t.id.replace(/[a-z]*/,"");if(t.options&&!t.disabled)for(var n=0;n<t.options.length;n++)if(t.options[n].value==e[i]){if(t.value=t.options[n].value,t.selectedIndex=n,t.childSettings)for(var a=0;a<t.childSettings.length;a++){var l=t.childSettings[a].id.replace(/[a-z]*/,"");"undefined"!=typeof choosedOptions[l]&&delete choosedOptions[l]}return choosedOptions[i]=t.value,allowMagicToolboxChange=!1,magicToolboxClickElement(t,"Event","change"),o++,void(o<spConfig.settings.length&&setTimeout(function(o,e){return function(){magicToolboxChangeOptions(o,e)}}(o,e),100))}}function magicToolboxInArray(o,e){for(var t={},i=0,n=e.length;n>i;i++)t[e[i]]="";return o in t?!0:!1}function magicToolboxOnChangeOptionConfigurable(o,e){if(!allowMagicToolboxChange)return void(allowMagicToolboxChange=!0);if("undefined"!=typeof useAssociatedProductImages){var t=o.id.replace(/[a-z]*/,"");if("undefined"!=typeof choosedOptions[t]&&delete choosedOptions[t],o.childSettings)for(var i=0,n=o.childSettings.length;n>i;i++){var a=o.childSettings[i].id.replace(/[a-z]*/,"");"undefined"!=typeof choosedOptions[a]&&delete choosedOptions[a]}{spConfig.config.productId}if(0===o.value.length)return;var l=magicToolboxFindProduct(t,o.value);choosedOptions[t]=o.value;var c=document.getElementById("imageConfigurable"+l);if(c)return allowMagicToolboxChange=!1,void magicToolboxClickElement(c.parentNode,"MouseEvents",magicToolboxSwitchMetod)}magicToolboxOnChangeOption(o,e)}function magicToolboxFindProduct(o,e){for(var t in optionProductIDs[o][e]){var i=optionProductIDs[o][e][t];for(var n in choosedOptions){var a=choosedOptions[n];for(var l in optionProductIDs[n][a])if(i==optionProductIDs[n][a][l]){a=null;break}if(null!=a){i=null;break}}if(null!=i)return i}return optionProductIDs[o][e][0]}function get_image_name(o){return o.replace(/.*\/(.*?)$/i,"$1")}var magicToolboxLinks=[],optionLabels={},optionTitles={},optionProductIDs={},choosedOptions={},allowMagicToolboxChange=!0;if("function"==typeof colorSelected){var colorSelectedBusy=!1;window.old_colorSelected=window.colorSelected,window.colorSelected=function(){jQuery("#image").attr("style","position:absolute;top:-10000px;"),old_colorSelected.apply(void 0,arguments),colorSelectedBusy||jQuery('.MagicToolboxSelectorsContainer a:not([rel=""])').each(function(){get_image_name(jQuery(this).attr("href"))==get_image_name(jQuery("#image").attr("src"))&&magicToolboxClickElement(this,"MouseEvents",magicToolboxSwitchMetod)})},window.old_magicToolboxOnChangeSelector=window.magicToolboxOnChangeSelector,window.magicToolboxOnChangeSelector=function(){old_magicToolboxOnChangeSelector.apply(void 0,arguments),jQuery('li.swatchContainer img[onclick*="'+get_image_name(jQuery(arguments[0]).attr("href"))+'"]').each(function(){colorSelectedBusy=!0,eval(jQuery(this).attr("onclick")),colorSelectedBusy=!1})}}